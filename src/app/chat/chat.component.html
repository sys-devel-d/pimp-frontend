<div class="row">

  <div class="col-md-4 chat-col">

    <div id="user-search-container">
      <searchField
        (update)="term = $event"
        (keyup)="searchForUser(term)"
        [privateChatCallback]="privateChatCallback"
        [groupChatCallback]="groupChatCallback"
        [results]="users">
      </searchField>
      <button class="btn btn-link" (click)="fetchUsersForSelectionAndOpenDialog()">Neuer Gruppenchat</button>
      <div *ngIf="error" class="alert alert-danger">{{error}}</div>
    </div>

    <div id="room-container">
      <div *ngFor='let room of rooms' (click)="setCurrentRoom(room)">
        <div class="room-container" [ngClass]="{ 'selected': room.roomName == currentRoom.roomName }">
          <div class="col-md-8 room-content">
            <div class="roomname">{{ room | roomName }}</div>
            <div class="most-recent-message">{{ room.messages.length > 0 ? room.messages[room.messages.length - 1].message : "..." }}</div>
          </div>
          <div class="col-md-4 edit-room-actions">
            <i title="Bearbeiten" class="fa fa-pencil-square-o" aria-hidden="true" *ngIf="room.roomType == 'GROUP'" (click)="prepareEditingRoom(room)"></i>
            <i title="Verlassen" class="fa fa-sign-out" aria-hidden="true" *ngIf="room.roomType == 'GROUP'" (click)="exitRoom(room)"></i>
          </div>
        </div>
      </div>
    </div>

  </div>

  <div class="col-md-8 pull-right chat-col">
    <form (ngSubmit)="send()">
      <input id="message-input" type="text" [(ngModel)]="text" class="form-control"
        placeholder="Enter message..." [ngModelOptions]="{standalone: true}">
    </form>
    <div *ngIf="currentRoom" id="chat-message-container">
      <div class="chat-message" *ngFor='let message of currentRoom.messages'>
        [{{ message.creationDate | jdate }}] => {{message.userName}}: {{ message.message }}
      </div>
    </div>
  </div>

</div>

<group-chat-editor [updateRoom]="updateRoomCallback"></group-chat-editor>